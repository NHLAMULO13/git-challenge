!function(){"use strict";function e(t){return(e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(t)}function t(t){this.foundVideoPlayers=[],this.SearchForNewVideoPlayersInterval=5e3,this.newVideoFoundCallback=t,this.startSearching=function(){this.trackVideos()},this.trackVideos=function(){this.searchForVideosInWindow(window);var e=window.document.getElementsByTagName("iframe"),t=this;function i(e){var i=!1;try{i=e.contentWindow}catch(n){return}i&&t.searchForVideosInWindow(e.contentWindow)}for(var n=0;n<e.length;n++)i(e[n]);setTimeout((function(){t.trackVideos()}),this.SearchForNewVideoPlayersInterval)},this.searchForVideosInWindow=function(e){try{e.jwplayer}catch(t){return}this.searchForFlowPlayerPlayersInWindow(e),this.searchForJWPlayerPlayersInWindow(e),this.searchForVideoJSPlayersInWindow(e),this.searchForGreenVideoPlayersInWindow(e),this.searchForHearstVideoPlayersInWindow(e)},this.searchForFlowPlayerPlayersInWindow=function(e){if(e.flowplayer){var t=[],i=0;if(void 0===e.flowplayer.instances)return;for(e.flowplayer.instances.forEach((function(e){t.push(e)})),i=0;i<t.length;i++)this.foundVideoPlayers.indexOf(t[i])<0&&(this.foundVideoPlayers.push(t[i]),this.newVideoFoundCallback("flowPlayer",e.flowplayer.version,t[i]))}},this.searchForJWPlayerPlayersInWindow=function(e){if(e.jwplayer){var t=[],i=e.jwplayer.version;for(n=0;e.jwplayer(n)&&e.jwplayer(n).id;)t.push(e.jwplayer(n)),n++;for(var n=0;n<t.length;n++){for(var o=!0,r=0;r<this.foundVideoPlayers.length;r++)this.foundVideoPlayers[r].id&&this.foundVideoPlayers[r].id==t[n].id&&(o=!1);o&&(this.foundVideoPlayers.push(t[n]),this.newVideoFoundCallback("jwPlayer",t[n].version?t[n].version:i,t[n]))}}},this.searchForVideoJSPlayersInWindow=function(t){if(t.videojs&&"object"==e(t.videojs.players))for(var i in t.videojs.players){var n=t.videojs.players[i];n&&this.foundVideoPlayers.indexOf(n)<0&&(this.foundVideoPlayers.push(n),this.newVideoFoundCallback("videojs",t.videojs.VERSION,n))}},this.searchForGreenVideoPlayersInWindow=function(e){var t=this;window.customElements&&"function"==typeof window.customElements.whenDefined&&window.customElements.whenDefined("green-video").then((function(){var e=document.querySelector("green-video");e&&!e.dotmetricsPluginRegistered&&e.data&&(e.dotmetricsPluginRegistered=!0,t.newVideoFoundCallback("green-video",1,e))}))},this.searchForHearstVideoPlayersInWindow=function(e){if(e.videoPlayerManager&&Array.isArray(e.videoPlayerManager.instances))for(var t=0;t<e.videoPlayerManager.instances.length;t++){var i=e.videoPlayerManager.instances[t];i&&this.foundVideoPlayers.indexOf(i)<0&&(this.foundVideoPlayers.push(i),this.newVideoFoundCallback("hearst-video",1,i))}},this.manuallyAddVideoPlayerInstance=function(t,i){if(t&&"object"===e(t)){if("flowPlayer"===i){if(!this.validateFPInstance(t))throw new Error("Invalid FlowPlayer instance")}else if("jwPlayer"===i){if(!this._validateJWPlayerInstance(t))throw new Error("Invalid jwPlayer instance")}else if("videojs"===i){if(!this._validateVideoJSInstance(t))throw new Error("Invalid videojs player instance")}else{if("green-video"!==i)throw new Error("Invalid video player type");if(!this._validateGreenVideoInstance(t))throw new Error("Invalid green-video player instance")}for(var n=0;n<this.foundVideoPlayers.length;n++)if(this.foundVideoPlayers[n]===t)return!1;return this.foundVideoPlayers.push(t),this.newVideoFoundCallback(i,null,t),!0}},this.validateFPInstance=function(t){if(!t||"object"!==e(t))return!1;for(var i=0,n=["currentSrc","duration","currentTime","videoWidth","videoHeight","opts","playerState"];i<n.length;i++){if(!(n[i]in t))return!1}if("string"!=typeof t.currentSrc||"number"!=typeof t.duration||"number"!=typeof t.currentTime||"number"!=typeof t.videoWidth||"number"!=typeof t.videoHeight||"object"!==e(t.opts)||"object"!==e(t.playerState))return!1;for(var o=0,r=["on","off"];o<r.length;o++){if("function"!=typeof t[r[o]])return!1}return!0},this._validateJWPlayerInstance=function(t){if(!t||"object"!==e(t))return!1;for(var i=0,n=["getPlaylistItem","getWidth","getHeight","getDuration","getPosition","on","off"];i<n.length;i++){if("function"!=typeof t[n[i]])return!1}return"function"==typeof t.on||"function"==typeof t.onPlay&&"function"==typeof t.onSeek&&"function"==typeof t.onTime},this._validateVideoJSInstance=function(t){if(!t||"object"!==e(t))return!1;for(var i=0,n=["currentSrc","duration","currentTime","on","off","seeking"];i<n.length;i++){if("function"!=typeof t[n[i]])return!1}var o="function"==typeof t.videoWidth||"function"==typeof t.width,r="function"==typeof t.videoHeight||"function"==typeof t.height;return!(!o||!r)},this._validateGreenVideoInstance=function(t){if(!t||"object"!==e(t))return!1;for(var i=["ad","config","data","plugin","tracking","ui","vendor","video"],n=0;n<i.length;n++)if(!t[i[n]])return!1;return"object"===e(t.ad)&&"object"===e(t.config)&&"object"===e(t.data)&&"object"===e(t.plugin)&&"object"===e(t.tracking)&&"object"===e(t.ui)&&"object"===e(t.vendor)&&"object"===e(t.video)&&"function"==typeof t.plugin.register}}var i=new function(){this.SettingsObject=window.DotMetricsSettings,this.SettingsObject.NCSHitUrl="/unconsentedvideohit.gif",this.baseUrlPrefix=this.SettingsObject.BaseUrl,this._sentVideoUrls=[],this.videoPlayerSearch=null,this.Start=function(){var e=this;this.videoPlayerSearch=new t((function(t,i,n){switch(t){case"flowPlayer":e.trackFP(n);break;case"jwPlayer":e.trackJW(n);break;case"videojs":e.trackVideoJS(n);break;case"green-video":e.trackGreenVideo(n)}})),1==this.SettingsObject.VideoSearchEnabled&&this.videoPlayerSearch.startSearching()},this.AddVideoPlayer=function(e,t){if(null!=this.videoPlayerSearch)try{return this.videoPlayerSearch.manuallyAddVideoPlayerInstance(e,t)}catch(i){throw i}},this.sendData=function(e){if(!(this._sentVideoUrls.indexOf(e)>=0)){var t=this.SettingsObject.SiteSectionId,i=window.location.hostname,n=encodeURIComponent(window.location),o=this.SettingsObject.EventChainId,r=(new Date).getTimezoneOffset(),a=this.baseUrlPrefix+this.SettingsObject.NCSHitUrl+"?videoUrl="+e+"&id="+t+"&dom="+i+"&url="+n+"&ecid="+o+"&tzOffset="+r+"&ver="+this.SettingsObject.ScriptVersion;(new Image).src=a,this._sentVideoUrls.push(e)}},this.trackFP=function(e){var t=this;e.on("playing",(function(i){t.sendData(e.currentSrc)}))},this.trackJW=function(e){var t=this;e.on("play",(function(i){var n=e.getPlaylistItem();void 0!==n&&t.sendData(n.file)}))},this.trackVideoJS=function(e){var t=this;e.on("play",(function(){t.sendData(e.currentSrc())}))},this.AddVideoPlayer=function(e,t){if(null!=this.videoPlayerSearch)try{return this.videoPlayerSearch.manuallyAddVideoPlayerInstance(e,t)}catch(i){throw i}},this.trackGreenVideo=function(e){var t=this;try{e.plugin.register("pluginVendorMiddleware",(function(e,i){if("video/PLAY"===e.type)n=i(),t.sendData(n.video.sources[0].src);var n}))}catch(i){}}};window.DotMetricsObj={AddVideoPlayer:function(e,t){return i.AddVideoPlayer(e,t)}},top.location==self.location&&setTimeout((function(){i.Start()}),100)}();
